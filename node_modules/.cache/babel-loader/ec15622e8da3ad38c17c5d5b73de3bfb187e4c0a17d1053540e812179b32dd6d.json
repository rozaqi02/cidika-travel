{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect, useState } from \"react\";\nimport { supabase } from \"../lib/supabaseClient\";\nimport { useTranslation } from \"react-i18next\";\nexport default function usePackages() {\n  _s();\n  const {\n    i18n\n  } = useTranslation();\n  const lang = (i18n.resolvedLanguage || 'en').split('-')[0];\n  const [rows, setRows] = useState([]);\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    let on = true;\n    (async () => {\n      setLoading(true);\n      const {\n        data,\n        error\n      } = await supabase.from('packages').select(`\n          id, slug, default_image, is_active,\n          package_locales ( lang, title, summary, spots, itinerary, include, note ),\n          price_tiers ( pax, price_idr, audience )\n        `).eq('is_active', true);\n      if (!on) return;\n      if (error) {\n        console.error(error);\n        setRows([]);\n        setLoading(false);\n        return;\n      }\n      const mapped = (data || []).map(p => {\n        var _p$package_locales, _p$package_locales2, _p$package_locales3;\n        const loc = ((_p$package_locales = p.package_locales) === null || _p$package_locales === void 0 ? void 0 : _p$package_locales.find(l => l.lang === lang)) || ((_p$package_locales2 = p.package_locales) === null || _p$package_locales2 === void 0 ? void 0 : _p$package_locales2.find(l => l.lang === 'en')) || ((_p$package_locales3 = p.package_locales) === null || _p$package_locales3 === void 0 ? void 0 : _p$package_locales3[0]) || {};\n        return {\n          ...p,\n          locale: loc\n        };\n      });\n      setRows(mapped);\n      setLoading(false);\n    })();\n    return () => {\n      on = false;\n    };\n  }, [lang]);\n  return {\n    rows,\n    loading,\n    lang\n  };\n}\n_s(usePackages, \"6SXHNVjUKonk9vJ0A3ak+ZSL2n8=\", false, function () {\n  return [useTranslation];\n});","map":{"version":3,"names":["useEffect","useState","supabase","useTranslation","usePackages","_s","i18n","lang","resolvedLanguage","split","rows","setRows","loading","setLoading","on","data","error","from","select","eq","console","mapped","map","p","_p$package_locales","_p$package_locales2","_p$package_locales3","loc","package_locales","find","l","locale"],"sources":["C:/Projects/cidika-travel/src/hooks/usePackages.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { supabase } from \"../lib/supabaseClient\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\nexport default function usePackages() {\r\n  const { i18n } = useTranslation();\r\n  const lang = (i18n.resolvedLanguage || 'en').split('-')[0];\r\n  const [rows, setRows] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    let on = true;\r\n    (async () => {\r\n      setLoading(true);\r\n      const { data, error } = await supabase\r\n        .from('packages')\r\n        .select(`\r\n          id, slug, default_image, is_active,\r\n          package_locales ( lang, title, summary, spots, itinerary, include, note ),\r\n          price_tiers ( pax, price_idr, audience )\r\n        `)\r\n        .eq('is_active', true);\r\n      if (!on) return;\r\n      if (error) { console.error(error); setRows([]); setLoading(false); return; }\r\n      const mapped = (data || []).map(p => {\r\n        const loc = p.package_locales?.find(l => l.lang === lang)\r\n          || p.package_locales?.find(l => l.lang === 'en')\r\n          || p.package_locales?.[0] || {};\r\n        return { ...p, locale: loc };\r\n      });\r\n      setRows(mapped);\r\n      setLoading(false);\r\n    })();\r\n    return () => { on = false; };\r\n  }, [lang]);\r\n\r\n  return { rows, loading, lang };\r\n}\r\n"],"mappings":";AAAA,SAASA,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC3C,SAASC,QAAQ,QAAQ,uBAAuB;AAChD,SAASC,cAAc,QAAQ,eAAe;AAE9C,eAAe,SAASC,WAAWA,CAAA,EAAG;EAAAC,EAAA;EACpC,MAAM;IAAEC;EAAK,CAAC,GAAGH,cAAc,CAAC,CAAC;EACjC,MAAMI,IAAI,GAAG,CAACD,IAAI,CAACE,gBAAgB,IAAI,IAAI,EAAEC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;EAC1D,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAGV,QAAQ,CAAC,EAAE,CAAC;EACpC,MAAM,CAACW,OAAO,EAAEC,UAAU,CAAC,GAAGZ,QAAQ,CAAC,IAAI,CAAC;EAE5CD,SAAS,CAAC,MAAM;IACd,IAAIc,EAAE,GAAG,IAAI;IACb,CAAC,YAAY;MACXD,UAAU,CAAC,IAAI,CAAC;MAChB,MAAM;QAAEE,IAAI;QAAEC;MAAM,CAAC,GAAG,MAAMd,QAAQ,CACnCe,IAAI,CAAC,UAAU,CAAC,CAChBC,MAAM,CAAC;AAChB;AACA;AACA;AACA,SAAS,CAAC,CACDC,EAAE,CAAC,WAAW,EAAE,IAAI,CAAC;MACxB,IAAI,CAACL,EAAE,EAAE;MACT,IAAIE,KAAK,EAAE;QAAEI,OAAO,CAACJ,KAAK,CAACA,KAAK,CAAC;QAAEL,OAAO,CAAC,EAAE,CAAC;QAAEE,UAAU,CAAC,KAAK,CAAC;QAAE;MAAQ;MAC3E,MAAMQ,MAAM,GAAG,CAACN,IAAI,IAAI,EAAE,EAAEO,GAAG,CAACC,CAAC,IAAI;QAAA,IAAAC,kBAAA,EAAAC,mBAAA,EAAAC,mBAAA;QACnC,MAAMC,GAAG,GAAG,EAAAH,kBAAA,GAAAD,CAAC,CAACK,eAAe,cAAAJ,kBAAA,uBAAjBA,kBAAA,CAAmBK,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACvB,IAAI,KAAKA,IAAI,CAAC,OAAAkB,mBAAA,GACpDF,CAAC,CAACK,eAAe,cAAAH,mBAAA,uBAAjBA,mBAAA,CAAmBI,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACvB,IAAI,KAAK,IAAI,CAAC,OAAAmB,mBAAA,GAC7CH,CAAC,CAACK,eAAe,cAAAF,mBAAA,uBAAjBA,mBAAA,CAAoB,CAAC,CAAC,KAAI,CAAC,CAAC;QACjC,OAAO;UAAE,GAAGH,CAAC;UAAEQ,MAAM,EAAEJ;QAAI,CAAC;MAC9B,CAAC,CAAC;MACFhB,OAAO,CAACU,MAAM,CAAC;MACfR,UAAU,CAAC,KAAK,CAAC;IACnB,CAAC,EAAE,CAAC;IACJ,OAAO,MAAM;MAAEC,EAAE,GAAG,KAAK;IAAE,CAAC;EAC9B,CAAC,EAAE,CAACP,IAAI,CAAC,CAAC;EAEV,OAAO;IAAEG,IAAI;IAAEE,OAAO;IAAEL;EAAK,CAAC;AAChC;AAACF,EAAA,CAjCuBD,WAAW;EAAA,QAChBD,cAAc;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}