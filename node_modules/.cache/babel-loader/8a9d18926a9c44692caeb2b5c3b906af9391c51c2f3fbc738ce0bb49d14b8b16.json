{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect, useState } from \"react\";\nimport { supabase } from \"../lib/supabaseClient.js\";\nimport { useTranslation } from \"react-i18next\";\nexport default function usePageSections(pageKey) {\n  _s();\n  const {\n    i18n\n  } = useTranslation();\n  const lang = (i18n.resolvedLanguage || i18n.language || \"en\").split(\"-\")[0];\n  const [sections, setSections] = useState([]);\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    let cancelled = false;\n    async function run() {\n      setLoading(true);\n      const {\n        data,\n        error\n      } = await supabase.from(\"page_sections\").select(\"id, page, section_key, sort_index, data, page_section_locales(*)\").eq(\"page\", pageKey).order(\"sort_index\", {\n        ascending: true\n      });\n      if (cancelled) return;\n      if (error) {\n        console.error(error);\n        setSections([]);\n        setLoading(false);\n        return;\n      }\n      const mapped = (data || []).map(s => {\n        const loc = (s.page_section_locales || []).find(x => x.lang === lang) || {};\n        return {\n          ...s,\n          locale: {\n            title: loc.title || \"\",\n            body_md: loc.body_md || \"\",\n            extra: loc.extra || null\n          }\n        };\n      });\n      setSections(mapped);\n      setLoading(false);\n    }\n    run();\n    return () => {\n      cancelled = true;\n    };\n  }, [pageKey, lang]);\n  return {\n    sections,\n    loading\n  };\n}\n_s(usePageSections, \"0KfG+cbZH9da731nR40tGKUBFbw=\", false, function () {\n  return [useTranslation];\n});","map":{"version":3,"names":["useEffect","useState","supabase","useTranslation","usePageSections","pageKey","_s","i18n","lang","resolvedLanguage","language","split","sections","setSections","loading","setLoading","cancelled","run","data","error","from","select","eq","order","ascending","console","mapped","map","s","loc","page_section_locales","find","x","locale","title","body_md","extra"],"sources":["C:/Projects/cidika-travel/src/hooks/usePageSections.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { supabase } from \"../lib/supabaseClient.js\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\nexport default function usePageSections(pageKey) {\r\n  const { i18n } = useTranslation();\r\n  const lang = (i18n.resolvedLanguage || i18n.language || \"en\").split(\"-\")[0];\r\n  const [sections, setSections] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(()=>{\r\n    let cancelled = false;\r\n    async function run() {\r\n      setLoading(true);\r\n      const { data, error } = await supabase\r\n        .from(\"page_sections\")\r\n        .select(\"id, page, section_key, sort_index, data, page_section_locales(*)\")\r\n        .eq(\"page\", pageKey)\r\n        .order(\"sort_index\", { ascending: true });\r\n      if (cancelled) return;\r\n      if (error) { console.error(error); setSections([]); setLoading(false); return; }\r\n\r\n      const mapped = (data||[]).map(s => {\r\n        const loc = (s.page_section_locales || []).find(x => x.lang === lang) || {};\r\n        return { ...s, locale: { title: loc.title || \"\", body_md: loc.body_md || \"\", extra: loc.extra || null } };\r\n      });\r\n      setSections(mapped);\r\n      setLoading(false);\r\n    }\r\n    run();\r\n    return () => { cancelled = true; };\r\n  }, [pageKey, lang]);\r\n\r\n  return { sections, loading };\r\n}\r\n"],"mappings":";AAAA,SAASA,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC3C,SAASC,QAAQ,QAAQ,0BAA0B;AACnD,SAASC,cAAc,QAAQ,eAAe;AAE9C,eAAe,SAASC,eAAeA,CAACC,OAAO,EAAE;EAAAC,EAAA;EAC/C,MAAM;IAAEC;EAAK,CAAC,GAAGJ,cAAc,CAAC,CAAC;EACjC,MAAMK,IAAI,GAAG,CAACD,IAAI,CAACE,gBAAgB,IAAIF,IAAI,CAACG,QAAQ,IAAI,IAAI,EAAEC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;EAC3E,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAGZ,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAACa,OAAO,EAAEC,UAAU,CAAC,GAAGd,QAAQ,CAAC,IAAI,CAAC;EAE5CD,SAAS,CAAC,MAAI;IACZ,IAAIgB,SAAS,GAAG,KAAK;IACrB,eAAeC,GAAGA,CAAA,EAAG;MACnBF,UAAU,CAAC,IAAI,CAAC;MAChB,MAAM;QAAEG,IAAI;QAAEC;MAAM,CAAC,GAAG,MAAMjB,QAAQ,CACnCkB,IAAI,CAAC,eAAe,CAAC,CACrBC,MAAM,CAAC,kEAAkE,CAAC,CAC1EC,EAAE,CAAC,MAAM,EAAEjB,OAAO,CAAC,CACnBkB,KAAK,CAAC,YAAY,EAAE;QAAEC,SAAS,EAAE;MAAK,CAAC,CAAC;MAC3C,IAAIR,SAAS,EAAE;MACf,IAAIG,KAAK,EAAE;QAAEM,OAAO,CAACN,KAAK,CAACA,KAAK,CAAC;QAAEN,WAAW,CAAC,EAAE,CAAC;QAAEE,UAAU,CAAC,KAAK,CAAC;QAAE;MAAQ;MAE/E,MAAMW,MAAM,GAAG,CAACR,IAAI,IAAE,EAAE,EAAES,GAAG,CAACC,CAAC,IAAI;QACjC,MAAMC,GAAG,GAAG,CAACD,CAAC,CAACE,oBAAoB,IAAI,EAAE,EAAEC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACxB,IAAI,KAAKA,IAAI,CAAC,IAAI,CAAC,CAAC;QAC3E,OAAO;UAAE,GAAGoB,CAAC;UAAEK,MAAM,EAAE;YAAEC,KAAK,EAAEL,GAAG,CAACK,KAAK,IAAI,EAAE;YAAEC,OAAO,EAAEN,GAAG,CAACM,OAAO,IAAI,EAAE;YAAEC,KAAK,EAAEP,GAAG,CAACO,KAAK,IAAI;UAAK;QAAE,CAAC;MAC3G,CAAC,CAAC;MACFvB,WAAW,CAACa,MAAM,CAAC;MACnBX,UAAU,CAAC,KAAK,CAAC;IACnB;IACAE,GAAG,CAAC,CAAC;IACL,OAAO,MAAM;MAAED,SAAS,GAAG,IAAI;IAAE,CAAC;EACpC,CAAC,EAAE,CAACX,OAAO,EAAEG,IAAI,CAAC,CAAC;EAEnB,OAAO;IAAEI,QAAQ;IAAEE;EAAQ,CAAC;AAC9B;AAACR,EAAA,CA9BuBF,eAAe;EAAA,QACpBD,cAAc;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}